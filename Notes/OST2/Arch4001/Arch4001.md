![[Pasted image 20251213224629.png]]
## Real Mode Execution Environment
- 8086/8088 16-bit Operating Mode
- ![[Pasted image 20251217234852.png]]
## Processor State After Reset
- All registers except EDX reset to 0.
- EDX contains the CPU stepping identification information.
- Base registers are 0 with the exception of CS which is 0xF000.
### CS.BASE + EIP
- CS.BASE is pre-set to 0xFFFF_0000 upon CPU reset/power-up.
- EIP set to 0x0000_FFF0.
- CS.BASE + EIP = 0xFFFF_FFF0.
### Control Registers
- CR2, CR3, CR4 are all 0.
- CR0 is 6000_0010h.
- Protection Enable is 0.
- Page is disabled.
## Real Mode Segmentation
- 20-bit segmented memory access.
- When operating in real-address mode, the default addressing and operand size is 16 bits.
- Address-size override can be used in real mode to enable access to 32 bit addressing.
- Segment Selector is left-shifted 4 bits.
- 16-bit Segment Selector is then added to a 16-bit effective address.
- Addresses can overlap.
## Intel Codenames
- PCH - Platform Controller Hub
- ICH - I/O Controller Hub

| **Marketing Name**                | **Year of release** | **Codename(s)**                                              | **Short Codename**      | **Associated PCH** | **PCH Codename**          |
| --------------------------------- | ------------------- | ------------------------------------------------------------ | ----------------------- | ------------------ | ------------------------- |
| Intel Core i{3,5,7} Series (ICiS) | 2008                | Nehalem                                                      | Unknown                 | 5 Series           | Ibex Peak                 |
| ICiS 2nd Generation               | 2011                | Sandy Bridge                                                 | SNB                     | 6 Series           | Cougar Point              |
| ICiS 3rd Generation               | 2012                | Ivy Bridge                                                   | IVB                     | 7 Series           | Panther Point             |
| ICiS 4th Generation               | 2013                | Haswell                                                      | HSW                     | 8 Series           | Lynx Point                |
| ICiS 5th Generation               | 2014/2015           | Broadwell                                                    | BDW                     | 9 Series           | Wildcat Point             |
| ICiS 6th Generation               | 2015/2016           | Broadwell, Skylake                                           | BDW, SKL                | 100 Series         | Sunrise Point             |
| ICiS 7th Generation               | 2016/2017           | Skylake, Kaby Lake                                           | SKL, KBL                | 200 Series         | Union Point               |
| ICiS 8th Generation               | 2017/2018           | Kaby Lake, Coffee Lake, Amber Lake, Whisky Lake, Cannon Lake | KBL, CFL, AML, WHL, CNL | 200, 300 Series    | Coffee Lake, Cannon Point |
| ICiS 9th Generation               | 2018                | Skylake, Coffee Lake                                         | SKL, CFL                | 300 Series         | Coffee Lake               |
| ICiS 10th Generation              | 2019                | Cascade Lake, Ice Lake, Comet Lake, Amber Lake               | CSL, ICL, CML, AML      | 400 Series         | Comet Lake                |
| ICiS 11th Generation              | 2020/2021           | Tiger Lake, Rocket Lake                                      | TGL, RKL                | 500 Series         | Rocket Lake               |
| ICiS 12th Generation              | 2021                | Alder Lake                                                   | ADL                     | 600 Series         | Alder Lake                |
| ICiS 13th Generation              | 2022                | Raptor Lake                                                  | RPL                     | 700 Series         | Raptor Lake               |
| ICiS 14th Generation              | 2023                | Meteor Lake                                                  | MTL                     |                    |                           |
| ICiS 15th Generation              | 2024                | Arrow Lake                                                   | ARL                     |                    |                           |
| ICiS 16th Generation Refresh      | 2025                | Lunar Lake                                                   | LNL                     |                    |                           |
| ICiS 17th Generation              | 2026                | Nova Lake                                                    | NVL                     |                    |                           |
- [DRAM Controller Device ID](https://gitlab.com/opensecuritytraining/arch4001_x86-64_rv_firmware_docs_for_class/-/tree/master/CPU)
## Chipsec 
- Instructions : 
1. Change directory to the chipsec folder with chipsec_util.py in it.
    1. **_If you have a 9 series chipset or older_**: Issue “_python chipsec_util.py pci read 0 0x1f 0 0xD8 2_”.
    2. **_If you have a 100 series chipset or newer_**: Issue “_python chipsec_util.py pci read 0 0x1f 5 0xD8 2_”.  
        This reads 2 bytes from some PCI register we don’t really understand yet. It should show a value of 0xFFCF.
2. Issue “_python chipsec_util.py mem read 0xFFF80000 0x10_”. This is the first 16 bytes of the un-unmappable range, mapping the last 256KB of the BIOS.
3. Issue “_python chipsec_util.py mem read 0xFFF7FFF0 0x10_”. It should show some non-0xFF values. If it shows 0xFFs, you got unlucky, try address 0xFFF6FFF0 or 0xFFF5FFF0 instead.
    1. **_If you have a 9 series chipset or older_**: Issue “_python chipsec_util.py pci write 0 0x1F 0 0xD8 2 0xBFCF_”.
    2. **_If you have a 100 series chipset or newer_**: Issue “_python chipsec_util.py pci write 0 0x1F 5 0xD8 2 0xBFCF_”.  
        This should un-set bit 14 of that register.
4. Optionally re-issue your chipset-specific pci read command from step 1.x to confirm the value was written.
5. Re-issue “_python chipsec_util.py mem read 0xFFF7FFF0 0x10_”. You should now see 0xFFs, because you have disabled the mapping of that memory range to the SPI flash chip that holds the BIOS.
6. Optionally, increase the read data size to 0x20, to see that it really did just cut off access before 0xFFF80000, but that stuff after 0xFFF80000 is still mapped. (Because that mapping can’t be disabled.)