## APIs
- Windows API `CreateFile`
- Native API `NtCreateFile`
- Kernel API `ZwCreateFile`
	- `ExAllocatePoolWithTag` - Kernel Only
## Processes & Threads
- Kernel tracks using a `_EPROCESS` structure and a `_ETHREAD`.
## Virtual Address Spaces
- Works by using per process page tables.
- Kernel Virtual Address Shadow (KVA Shadow) mitigation changes kernel space page table view.
## Hypervisor vs Kernel vs User
- Ring - 1 Hypervisor (All CPU instructions)
- Ring - 0 Kernel (Most CPU instructions)
- Ring - 3 User (Many CPU instructions)
## Simplified Architecture
- ![[Pasted image 20251111212136.png]]
### NTDLL.DLL
- Special system support library.
- Supports functions used by images and subsystems.
	- Image Loader
	- Heap Manager
	- Subset of CRT etc.
## I/O Processing
- ![[Pasted image 20251111212730.png]]
## Executive Layer
- Upper layer of `ntoskrnl.exe`
- Config, I/O, PnP, Power, Memory, Cache are all managed under this.
## Message Processing
- ![[Pasted image 20251111212910.png]]
